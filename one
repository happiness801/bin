#!/usr/bin/env bash
# 
# Super simple OneDrive search; assuming a listing was created similar to:
#    cd $ONEDRIVE && ll -R > LIST.OneDrive.ll-R.20200815-1322.txt
#

search=$1
type=search

if [[ -f $search ]]; then
	type=file
elif [[ -d $search ]]; then
	type=directory
else
	type=search
fi

if [[ $type == 'directory' ]]; then
	#cd $search/
	for f in $search/*
	do
		f=`basename $f`
			
		if [[ -f $f && $f != 'Thumbs.db' && $f != 'desktop.ini' ]]; then
			one `basename $f` || echo "Unable to find $f!"
		fi
	done

else
	egrep -i "(^\.|${search})" $ONEDRIVE/LIST.OneDrive.*.txt | grep -i -B 1 $search
fi
